<!doctype html>
<meta charset="utf-8">
<title>(g, Î²)ç­‰é«˜ç·šå›³ â€” PP-oscillation</title>
<style>
  :root { --line:#e5e7eb; --muted:#666; }
  body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", sans-serif; margin:16px; background:#fafafa; }
  .wrap { display:flex; flex-direction:column; gap:16px; }
  .card { background:#fff; border:1px solid var(--line); border-radius:12px; padding:14px; box-shadow:0 1px 2px rgba(0,0,0,.03); }
  .note { color:var(--muted); font-size:.92rem; line-height:1.6; margin-top:8px; }
  canvas { background:#fff; border:1px solid var(--line); border-radius:10px; width:100%; max-width:1200px; height:auto; }
  .section { border:1px solid #e5e7eb; border-radius:8px; padding:14px; margin-bottom:12px; background:#fafafa; }
  .section-title { font-size:1.05rem; font-weight:600; margin:0 0 10px; color:#374151; }
  .param-group { display:grid; grid-template-columns: 160px 1fr; gap:10px 10px; align-items:center; margin-top:10px; }
  .buttons { display:flex; gap:10px; margin-top:12px; flex-wrap:wrap; }
  button { padding:8px 12px; border-radius:8px; border:1px solid #d1d5db; background:#f8f8f8; cursor:pointer; }
  button:hover:not(:disabled) { background:#f0f0f0; }
  button:disabled { opacity:0.5; cursor:not-allowed; }
  input[type="number"], select { width:100%; box-sizing:border-box; }
  .nav { display:flex; gap:12px; flex-wrap:wrap; padding:10px 12px; border:1px solid var(--line); border-radius:10px; background:#fff; }
  .nav a { color:#2563eb; text-decoration:none; }
  .nav a:hover { text-decoration:underline; }
  #status { margin-top:10px; color:#555; font-size:.9rem; min-height:20px; }
  .progress { margin-top:8px; }
  .progress-bar { width:100%; height:6px; background:#e5e7eb; border-radius:3px; overflow:hidden; }
  .progress-fill { height:100%; background:#3b82f6; transition:width 0.3s ease; }
</style>

<div class="wrap">
  <div class="nav">
    <a href="../">Home</a>
    <span>Â·</span>
    <a href="../simulator/">Simulator</a>
    <span>Â·</span>
    <a href="../bifurcation/">Bifurcation</a>
    <span>Â·</span>
    <a href="../heatmap/">Heatmap</a>
    <span>Â·</span>
    <a href="../contour/">Contour (g,Î²)</a>
    <span>Â·</span>
    <a href="../workbench/">Modification Workbench</a>
  </div>

  <div class="card">
    <h2 style="margin:4px 0 10px;">(g, Î²) ç„¡æ¬¡å…ƒãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç©ºé–“ â€” å‘¨æœŸç­‰é«˜ç·šå›³</h2>
    <div style="display:flex; gap:16px; flex-wrap:wrap;">
      <div style="flex:2 1 520px; min-width:420px;">
        <canvas id="cv" width="1400" height="1200"></canvas>
        <div id="status"></div>
        <div class="progress" id="progressContainer" style="display:none;">
          <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
          </div>
        </div>
      </div>

      <div class="card" style="flex:1 1 360px; min-width:320px;">
        <!-- ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š -->
        <div class="section">
          <h3 class="section-title">ğŸ“Š ã‚°ãƒªãƒƒãƒ‰è¨­å®š</h3>
          <div class="param-group">
            <label for="gMin">g æœ€å°å€¤</label>
            <input id="gMin" type="number" step="0.1" value="1.0">
            <label for="gMax">g æœ€å¤§å€¤</label>
            <input id="gMax" type="number" step="0.1" value="4.0">
            <label for="gSteps">g åˆ†å‰²æ•°</label>
            <input id="gSteps" type="number" step="1" value="31">

            <label for="betaMin">Î² æœ€å°å€¤</label>
            <input id="betaMin" type="number" step="0.01" value="0.3">
            <label for="betaMax">Î² æœ€å¤§å€¤</label>
            <input id="betaMax" type="number" step="0.01" value="1.5">
            <label for="betaSteps">Î² åˆ†å‰²æ•°</label>
            <input id="betaSteps" type="number" step="1" value="25">
          </div>
        </div>

        <!-- ç­‰é«˜ç·šè¨­å®š -->
        <div class="section">
          <h3 class="section-title">ğŸ“ˆ ç­‰é«˜ç·šè¨­å®š</h3>
          <div class="param-group">
            <label for="contourLevels">ç­‰é«˜ç·šãƒ¬ãƒ™ãƒ« (ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Š)</label>
            <input id="contourLevels" type="text" value="30,45,60,75,90,120,150,180" style="grid-column:span 1;">
            <label><input type="checkbox" id="autoLevels" checked> è‡ªå‹•èª¿æ•´</label>
          </div>
        </div>

        <!-- ã‚·ãƒŠãƒªã‚ªè¨­å®š -->
        <div class="section">
          <h3 class="section-title">ğŸ¯ ã‚·ãƒŠãƒªã‚ªçŸ¢å°</h3>
          <div class="param-group">
            <label><input type="checkbox" id="showScenarios" checked> ã‚·ãƒŠãƒªã‚ªè¡¨ç¤º</label>
            <span></span>
            <label for="baseG">åŸºæº–ç‚¹ gâ‚€</label>
            <input id="baseG" type="number" step="0.1" value="2.5">
            <label for="baseBeta">åŸºæº–ç‚¹ Î²â‚€</label>
            <input id="baseBeta" type="number" step="0.01" value="0.8">
          </div>
          <div class="note" style="margin-top:8px; font-size:0.85rem;">
            ã‚·ãƒŠãƒªã‚ªã¯ä»®æƒ³çš„ãªä¿®é£¾åŠ¹æœã‚’ç¤ºã—ã¾ã™ï¼š<br>
            ãƒ»è»½åº¦: (r_assoc=1.1, r_poly=0.9)<br>
            ãƒ»ä¸­åº¦: (r_assoc=1.2, r_poly=0.8)<br>
            ãƒ»å¼·åº¦: (r_assoc=1.3, r_poly=0.7)
          </div>
        </div>

        <!-- ãƒ™ãƒ¼ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ -->
        <div class="section">
          <h3 class="section-title">âš™ï¸ ãƒ™ãƒ¼ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</h3>
          <div class="param-group">
            <label for="pol">pol [nM]</label>
            <input id="pol" type="number" step="0.01" value="3.7">
            <label for="rec">rec [nM]</label>
            <input id="rec" type="number" step="0.01" value="32.5">
            <label for="G">G [nM]</label>
            <input id="G" type="number" step="1" value="150">
            <label for="k2">kâ‚‚ [minâ»Â¹]</label>
            <input id="k2" type="number" step="0.0001" value="0.0031">
            <label for="kN">kN [minâ»Â¹]</label>
            <input id="kN" type="number" step="0.001" value="0.0210">
            <label for="kP">kP [minâ»Â¹]</label>
            <input id="kP" type="number" step="0.0001" value="0.0047">
            <label for="KmP">KmP [nM]</label>
            <input id="KmP" type="number" step="1" value="34">
            <label for="N0">Nâ‚€ [nM]</label>
            <input id="N0" type="number" step="0.1" value="10">
            <label for="P0">Pâ‚€ [nM]</label>
            <input id="P0" type="number" step="0.1" value="10">
            <label for="t_end">t_end [min]</label>
            <input id="t_end" type="number" step="100" value="3000">
            <label for="dt">dt [min]</label>
            <input id="dt" type="number" step="0.1" value="0.5">
            <label for="tail">è©•ä¾¡åŒºé–“ (æœ«å°¾%)</label>
            <input id="tail" type="number" step="1" value="60">
          </div>
        </div>

        <div class="buttons">
          <button id="runBtn">ğŸš€ ç­‰é«˜ç·šå›³ã‚’ç”Ÿæˆ</button>
          <button id="exportPngBtn" disabled>ğŸ’¾ PNGä¿å­˜</button>
          <button id="exportCsvBtn" disabled>ğŸ“Š CSVä¿å­˜</button>
        </div>
      </div>
    </div>
  </div>

  <!-- èª¬æ˜ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
  <div class="card" style="margin-top:8px;">
    <h3 style="margin:0 0 8px;">ç„¡æ¬¡å…ƒãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç©ºé–“ã®ç­‰é«˜ç·šå›³</h3>
    <h4 style="margin:0 0 6px;">ã“ã®ãƒ„ãƒ¼ãƒ«ã«ã¤ã„ã¦</h4>
    <p>
      ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ã€ç„¡æ¬¡å…ƒãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ <strong>g</strong> ã¨ <strong>Î²</strong> ã®2æ¬¡å…ƒç©ºé–“ã§æŒ¯å‹•å‘¨æœŸã‚’ç­‰é«˜ç·šã¨ã—ã¦å¯è¦–åŒ–ã—ã¾ã™ã€‚
    </p>
    <p>
      <strong>g</strong> ã¨ <strong>Î²</strong> ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¾ã™ï¼š
    </p>
    <ul style="line-height:1.8;">
      <li><strong>g</strong> = kâ‚ Ã— G / (kâ‚‚ Ã— KmP) â€” è¢«é£Ÿè€…ç”ŸæˆåŠ¹ç‡</li>
      <li><strong>Î²</strong> = b Ã— kâ‚‚ Ã— KmPÂ² / kâ‚ â€” é£½å’Œå¼·åº¦</li>
    </ul>
    <p>
      ã‚¢ãƒŸãƒé…¸ä¿®é£¾ã«ã‚ˆã‚‹ <code>r_assoc</code>, <code>r_poly</code>, <code>r_nick</code> ã®å¤‰åŒ–ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã« g ã¨ Î² ã«ä¼æ’­ã—ã¾ã™ï¼š
    </p>
    <ul style="line-height:1.8;">
      <li>g' = g Ã— (r_assoc Ã— r_poly / r_nick)</li>
      <li>Î²' = Î² Ã— (1 / r_poly)</li>
    </ul>
    <p>
      ã‚·ãƒŠãƒªã‚ªçŸ¢å°ã¯ã€ä»®æƒ³çš„ãªä¿®é£¾ã«ã‚ˆã£ã¦ç³»ãŒã©ã®æ–¹å‘ã«ç§»å‹•ã™ã‚‹ã‹ã‚’ç¤ºã—ã¾ã™ã€‚
      ã“ã‚Œã«ã‚ˆã‚Šã€å®Ÿé¨“æ¡ä»¶ã®æœ€é©åŒ–ã‚„å‘¨æœŸå»¶é•·ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ç†è§£ã«å½¹ç«‹ã¡ã¾ã™ã€‚
    </p>
  </div>
</div>

<script type="module" src="./contour.js"></script>
